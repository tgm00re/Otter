{"ast":null,"code":"import _toConsumableArray from\"/Users/thomasmoore/Documents/Personal Projects/Otter/src/main/myapp/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/thomasmoore/Documents/Personal Projects/Otter/src/main/myapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function WhoToFollow(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),friendIds=_useState4[0],setFriendIds=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),sentNotifs=_useState6[0],setSentNotifs=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),recipientIds=_useState8[0],setRecipientIds=_useState8[1];function handleCancelRequest(recipientId){var notifIdToDelete=-1;for(var i=0;i<sentNotifs.length;i++){if(sentNotifs[i].recipientId==recipientId){notifIdToDelete=sentNotifs[i].id;}}if(notifIdToDelete!==-1){axios.delete(\"http://localhost:8080/api/notifications/delete/\"+notifIdToDelete).then(function(response){var newSentNotif=_toConsumableArray(sentNotifs);newSentNotif.splice(newSentNotif.indexOf(notifIdToDelete));setSentNotifs(newSentNotif);var newArr=_toConsumableArray(recipientIds);var indexToRemove=newArr.indexOf(recipientId);newArr.splice(indexToRemove,1);setRecipientIds(newArr);}).catch(function(err){var newArr=_toConsumableArray(recipientIds);var indexToRemove=newArr.indexOf(recipientId);newArr.splice(indexToRemove,1);setRecipientIds(newArr);});}else{var newArr=_toConsumableArray(recipientIds);var indexToRemove=newArr.indexOf(recipientId);newArr.splice(indexToRemove,1);setRecipientIds(newArr);}}function handleFollow(secondUserId){var notification={message:\"Friend Request\",senderId:sessionStorage.getItem(\"user_id\"),senderName:props.loggedInUser.firstName+\" \"+props.loggedInUser.lastName,recipientId:secondUserId};axios.post(\"http://localhost:8080/api/notifications/create\",notification).then(function(response){var newSentNotif=_toConsumableArray(sentNotifs);newSentNotif.push(response.data);setSentNotifs(newSentNotif);var newRecipientIds=_toConsumableArray(recipientIds);newRecipientIds.push(response.data.recipientId);setRecipientIds(newRecipientIds);}).catch(function(error){return console.log(error);});}function handleUnfollow(secondUserId){var firstUserId=sessionStorage.getItem(\"user_id\");var link=\"http://localhost:8080/api/friendships/delete/\"+firstUserId+\"/\"+secondUserId;axios.delete(link).then(function(response){var newFriendIds=_toConsumableArray(friendIds);newFriendIds.splice(newFriendIds.indexOf(secondUserId),1);setFriendIds(newFriendIds);}).catch(function(error){return console.log(error);});}useEffect(function(){axios.get(\"http://localhost:8080/api/users/\").then(function(response){setUsers(response.data);findFriendIds();}).catch(function(err){return console.log(err);});},[]);function findFriendIds(){var link=\"http://localhost:8080/api/friendships/findAllFriends/\"+sessionStorage.getItem(\"user_id\");axios.get(link).then(function(response){return setFriendIds(response.data);}).catch(function(err){return console.log(err.response);});}useEffect(function(){var link=\"http://localhost:8080/api/notifications/find/sent/\"+sessionStorage.getItem(\"user_id\");axios.get(link).then(function(response){setSentNotifs(response.data);var sentIds=[];response.data.forEach(function(notif){sentIds.push(notif.recipientId);});setRecipientIds(sentIds);}).catch(function(err){return console.log(err);});},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:\"rgba(255,255,255,0.10)\"},className:\"rounded mt-5 px-2 py-3\",id:\"who-to-follow-container\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"bg-transparent\",children:\"Who to follow\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"bg-transparent px-1\",children:users.map(function(user,index){if(user.userId!=sessionStorage.getItem(\"user_id\")){return/*#__PURE__*/_jsxs(\"li\",{className:\"d-flex justify-content-between align-items-center bg-transparent my-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.profileImageUrl,alt:\"\",className:\"rounded-circle bg-transparent profile-img\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-transparent post-acc-link-txt\",children:[user.firstName,\" \",user.lastName]}),recipientIds.includes(user.userId)?/*#__PURE__*/_jsx(\"button\",{className:\"btn rounded-pill bg-light p-2\",onClick:function onClick(e){return handleCancelRequest(user.userId);},children:\"Requested\"}):!friendIds.includes(user.userId)?/*#__PURE__*/_jsx(\"button\",{className:\"btn rounded-pill bg-light p-2\",onClick:function onClick(e){return handleFollow(user.userId);},children:\"Follow\"}):/*#__PURE__*/_jsx(\"button\",{className:\"btn rounded-pill bg-light p-2\",onClick:function onClick(e){return handleUnfollow(user.userId);},children:\"Unfollow\"})]},index);}})})]});}","map":{"version":3,"sources":["/Users/thomasmoore/Documents/Personal Projects/Otter/src/main/myapp/src/Components/WhoToFollow.jsx"],"names":["axios","React","useEffect","useState","WhoToFollow","props","users","setUsers","friendIds","setFriendIds","sentNotifs","setSentNotifs","recipientIds","setRecipientIds","handleCancelRequest","recipientId","notifIdToDelete","i","length","id","delete","then","response","newSentNotif","splice","indexOf","newArr","indexToRemove","catch","err","handleFollow","secondUserId","notification","message","senderId","sessionStorage","getItem","senderName","loggedInUser","firstName","lastName","post","push","data","newRecipientIds","error","console","log","handleUnfollow","firstUserId","link","newFriendIds","get","findFriendIds","sentIds","forEach","notif","backgroundColor","map","user","index","userId","profileImageUrl","includes","e"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport React, { useEffect, useState } from 'react'\n\n\n\n\n\nexport default function WhoToFollow(props) {\n    const [users, setUsers] = useState([]);\n    const [friendIds, setFriendIds] = useState([]);\n    const [sentNotifs, setSentNotifs] = useState([]);\n    const [recipientIds, setRecipientIds] = useState([]);\n\n    function handleCancelRequest(recipientId) {\n        let notifIdToDelete = -1;\n        for (let i = 0; i < sentNotifs.length; i++) {\n            if (sentNotifs[i].recipientId == recipientId) {\n                notifIdToDelete = sentNotifs[i].id;\n            }\n        }\n        if(notifIdToDelete !== -1){\n        axios.delete(\"http://localhost:8080/api/notifications/delete/\" + notifIdToDelete)\n            .then(response => {\n                let newSentNotif = [...sentNotifs];\n                newSentNotif.splice(newSentNotif.indexOf(notifIdToDelete));\n                setSentNotifs(newSentNotif);\n\n                let newArr = [...recipientIds];\n                const indexToRemove = newArr.indexOf(recipientId);\n                newArr.splice(indexToRemove, 1);\n                setRecipientIds(newArr);\n\n            })\n            .catch(err => {\n                let newArr = [...recipientIds];\n                const indexToRemove = newArr.indexOf(recipientId);\n                newArr.splice(indexToRemove, 1);\n                setRecipientIds(newArr);\n            })\n        } else {\n            let newArr = [...recipientIds];\n            const indexToRemove = newArr.indexOf(recipientId);\n            newArr.splice(indexToRemove, 1);\n            setRecipientIds(newArr);\n        }\n        \n    }\n\n\n    function handleFollow(secondUserId) {\n        const notification = {\n            message: \"Friend Request\",\n            senderId: sessionStorage.getItem(\"user_id\"),\n            senderName: props.loggedInUser.firstName + \" \" + props.loggedInUser.lastName,\n            recipientId: secondUserId\n        }\n        axios.post(\"http://localhost:8080/api/notifications/create\", notification)\n            .then(response => {\n                let newSentNotif = [...sentNotifs];\n                newSentNotif.push(response.data);\n                setSentNotifs(newSentNotif);\n\n                let newRecipientIds = [...recipientIds];\n                newRecipientIds.push(response.data.recipientId);\n                setRecipientIds(newRecipientIds);\n            })\n            .catch(error => console.log(error));\n    }\n\n    function handleUnfollow(secondUserId) {\n        const firstUserId = sessionStorage.getItem(\"user_id\");\n        const link = \"http://localhost:8080/api/friendships/delete/\" + firstUserId + \"/\" + secondUserId;\n        axios.delete(link)\n            .then(response => {\n                let newFriendIds = [...friendIds];\n                newFriendIds.splice(newFriendIds.indexOf(secondUserId), 1);\n                setFriendIds(newFriendIds);\n            })\n            .catch(error => console.log(error))\n    }\n\n\n    useEffect(() => {\n\n        axios.get(\"http://localhost:8080/api/users/\")\n            .then(response => {\n                setUsers(response.data);\n                findFriendIds();\n\n            })\n            .catch(err => console.log(err))\n    }, [])\n\n    function findFriendIds() {\n        const link = \"http://localhost:8080/api/friendships/findAllFriends/\" + sessionStorage.getItem(\"user_id\");\n        axios.get(link)\n            .then(response => setFriendIds(response.data))\n            .catch(err => console.log(err.response));\n    }\n\n\n\n    useEffect(() => {\n        const link = \"http://localhost:8080/api/notifications/find/sent/\" + sessionStorage.getItem(\"user_id\");\n        axios.get(link)\n            .then(response => {\n                setSentNotifs(response.data);\n                let sentIds = [];\n                response.data.forEach(notif => {\n                    sentIds.push(notif.recipientId);\n                })\n                setRecipientIds(sentIds);\n            })\n            .catch(err => console.log(err));\n    }, [])\n\n\n\n    return (\n        <div style={{ backgroundColor: \"rgba(255,255,255,0.10)\" }} className=\"rounded mt-5 px-2 py-3\" id=\"who-to-follow-container\">\n            <h3 className=\"bg-transparent\">Who to follow</h3>\n            <ul className=\"bg-transparent px-1\">\n                {users.map((user, index) => {\n                    if (user.userId != sessionStorage.getItem(\"user_id\")) {\n                        return (\n                            <li className=\"d-flex justify-content-between align-items-center bg-transparent my-3\" key={index}>\n                                <img src={user.profileImageUrl} alt=\"\" className=\"rounded-circle bg-transparent profile-img\" />\n                                <span className=\"bg-transparent post-acc-link-txt\">{user.firstName} {user.lastName}</span>\n                                {\n                                    recipientIds.includes(user.userId) ? (\n                                        <button className=\"btn rounded-pill bg-light p-2\" onClick={e => handleCancelRequest(user.userId)}>Requested</button>\n                                    )\n\n                                        : !friendIds.includes(user.userId) ? (\n                                            <button className=\"btn rounded-pill bg-light p-2\" onClick={e => handleFollow(user.userId)}>Follow</button>\n                                        )\n                                            : <button className=\"btn rounded-pill bg-light p-2\" onClick={e => handleUnfollow(user.userId)}>Unfollow</button>\n                                }\n                            </li>\n                        )\n                    }\n                })}\n            </ul>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}